<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Computational Methods for Electronics &amp; Robotics Lab">

<title>3&nbsp; Lab Session 2: Solving First-Order Linear PDEs Using Finite Difference Method (FDM) – 24BSE2113D- Partial Differential Equation, Transform and Optimization</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./03-laplace-basics.html" rel="next">
<link href="./01-intro-python.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-364982630eef5352dd1537128a8ed5cb.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./02-pde-numerical.html">Partial Differential Equations</a></li><li class="breadcrumb-item"><a href="./02-pde-numerical.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Lab Session 2: Solving First-Order Linear PDEs Using Finite Difference Method (FDM)</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">24BSE2113D- Partial Differential Equation, Transform and Optimization</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/sijuswamyresearch/PDE-T-and-OT" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./24BSE2113D--Partial-Differential-Equation,-Transform-and-Optimization.pdf">
              <i class="bi bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./24BSE2113D--Partial-Differential-Equation,-Transform-and-Optimization.epub">
              <i class="bi bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
      </ul>
    </div>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-1" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-1">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Welcome to the Computational Methods Lab</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Fundamentals</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro-python.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Lab Session 1: Python’s Scientific Stack</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Partial Differential Equations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-pde-numerical.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Lab Session 2: Solving First-Order Linear PDEs Using Finite Difference Method (FDM)</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Laplace Transforms &amp; System Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-laplace-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Lab Session 3: Symbolic operations in Laplace Transform</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-laplace-apps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Lab Session 4: Applications of Laplace Transform</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Optimization</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-optimization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Lab Session 5: Optimization Methods in Engineering</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Capstone Projects</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-capstone-project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Chapter 6: Capstone Project - A.R.E.S.</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-capstone-project-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Chapter 7: Capstone Project-II - P.A.T.H.F.I.N.D.E.R.</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#theoretical-background" id="toc-theoretical-background" class="nav-link active" data-scroll-target="#theoretical-background"><span class="header-section-number">3.1</span> Theoretical Background</a></li>
  <li><a href="#experiment-2-1d-wave-equation-the-advection-equation" id="toc-experiment-2-1d-wave-equation-the-advection-equation" class="nav-link" data-scroll-target="#experiment-2-1d-wave-equation-the-advection-equation"><span class="header-section-number">3.2</span> Experiment 2: 1D Wave Equation (The Advection Equation)</a>
  <ul class="collapse">
  <li><a href="#aim" id="toc-aim" class="nav-link" data-scroll-target="#aim"><span class="header-section-number">3.2.1</span> Aim</a></li>
  <li><a href="#objectives" id="toc-objectives" class="nav-link" data-scroll-target="#objectives"><span class="header-section-number">3.2.2</span> Objectives</a></li>
  <li><a href="#the-upwind-method-algorithm" id="toc-the-upwind-method-algorithm" class="nav-link" data-scroll-target="#the-upwind-method-algorithm"><span class="header-section-number">3.2.3</span> The Upwind Method Algorithm</a></li>
  <li><a href="#case-study-exponential-decay-wave" id="toc-case-study-exponential-decay-wave" class="nav-link" data-scroll-target="#case-study-exponential-decay-wave"><span class="header-section-number">3.2.4</span> Case Study: Exponential Decay Wave</a></li>
  <li><a href="#result-and-discussion" id="toc-result-and-discussion" class="nav-link" data-scroll-target="#result-and-discussion"><span class="header-section-number">3.2.5</span> Result and Discussion</a></li>
  </ul></li>
  <li><a href="#application-problem-stress-wave-in-a-rod" id="toc-application-problem-stress-wave-in-a-rod" class="nav-link" data-scroll-target="#application-problem-stress-wave-in-a-rod"><span class="header-section-number">3.3</span> Application Problem: Stress Wave in a Rod</a></li>
  <li><a href="#id-heat-equation--theoretical-background" id="toc-id-heat-equation--theoretical-background" class="nav-link" data-scroll-target="#id-heat-equation--theoretical-background"><span class="header-section-number">3.4</span> ID Heat Equation- Theoretical Background</a></li>
  <li><a href="#experiment-3-solving-the-1d-heat-equation" id="toc-experiment-3-solving-the-1d-heat-equation" class="nav-link" data-scroll-target="#experiment-3-solving-the-1d-heat-equation"><span class="header-section-number">3.5</span> Experiment 3: Solving the 1D Heat Equation</a>
  <ul class="collapse">
  <li><a href="#aim-1" id="toc-aim-1" class="nav-link" data-scroll-target="#aim-1"><span class="header-section-number">3.5.1</span> Aim</a></li>
  <li><a href="#objectives-1" id="toc-objectives-1" class="nav-link" data-scroll-target="#objectives-1"><span class="header-section-number">3.5.2</span> Objectives</a></li>
  <li><a href="#governing-equation-and-discretization" id="toc-governing-equation-and-discretization" class="nav-link" data-scroll-target="#governing-equation-and-discretization"><span class="header-section-number">3.5.3</span> Governing Equation and Discretization</a></li>
  <li><a href="#algorithm" id="toc-algorithm" class="nav-link" data-scroll-target="#algorithm"><span class="header-section-number">3.5.4</span> Algorithm</a></li>
  <li><a href="#sample-problem-and-python-implementation" id="toc-sample-problem-and-python-implementation" class="nav-link" data-scroll-target="#sample-problem-and-python-implementation"><span class="header-section-number">3.5.5</span> Sample Problem and <code>Python</code> Implementation</a></li>
  </ul></li>
  <li><a href="#application-challenge-heat-dissipation-in-a-longer-rod" id="toc-application-challenge-heat-dissipation-in-a-longer-rod" class="nav-link" data-scroll-target="#application-challenge-heat-dissipation-in-a-longer-rod"><span class="header-section-number">3.6</span> Application Challenge: Heat Dissipation in a Longer Rod</a></li>
  <li><a href="#second-order-1d-wave-equation--theoretical-background" id="toc-second-order-1d-wave-equation--theoretical-background" class="nav-link" data-scroll-target="#second-order-1d-wave-equation--theoretical-background"><span class="header-section-number">3.7</span> Second order 1D Wave Equation- Theoretical Background</a></li>
  <li><a href="#experiment-4-the-second-order-1d-wave-equation" id="toc-experiment-4-the-second-order-1d-wave-equation" class="nav-link" data-scroll-target="#experiment-4-the-second-order-1d-wave-equation"><span class="header-section-number">3.8</span> Experiment 4: The Second-Order 1D Wave Equation</a>
  <ul class="collapse">
  <li><a href="#aim-2" id="toc-aim-2" class="nav-link" data-scroll-target="#aim-2"><span class="header-section-number">3.8.1</span> Aim</a></li>
  <li><a href="#objectives-2" id="toc-objectives-2" class="nav-link" data-scroll-target="#objectives-2"><span class="header-section-number">3.8.2</span> Objectives</a></li>
  <li><a href="#governing-equation-and-discretization-1" id="toc-governing-equation-and-discretization-1" class="nav-link" data-scroll-target="#governing-equation-and-discretization-1"><span class="header-section-number">3.8.3</span> Governing Equation and Discretization</a></li>
  <li><a href="#algorithm-1" id="toc-algorithm-1" class="nav-link" data-scroll-target="#algorithm-1"><span class="header-section-number">3.8.4</span> Algorithm</a></li>
  <li><a href="#application-problem-and-python-implementation" id="toc-application-problem-and-python-implementation" class="nav-link" data-scroll-target="#application-problem-and-python-implementation"><span class="header-section-number">3.8.5</span> Application Problem and Python Implementation</a></li>
  </ul></li>
  <li><a href="#application-challenge-vibration-in-a-flexible-robot-link" id="toc-application-challenge-vibration-in-a-flexible-robot-link" class="nav-link" data-scroll-target="#application-challenge-vibration-in-a-flexible-robot-link"><span class="header-section-number">3.9</span> Application Challenge: Vibration in a Flexible Robot Link</a>
  <ul class="collapse">
  <li><a href="#solution-to-the-robotics-application-challenge" id="toc-solution-to-the-robotics-application-challenge" class="nav-link" data-scroll-target="#solution-to-the-robotics-application-challenge"><span class="header-section-number">3.9.1</span> Solution to the Robotics Application Challenge</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./02-pde-numerical.html">Partial Differential Equations</a></li><li class="breadcrumb-item"><a href="./02-pde-numerical.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Lab Session 2: Solving First-Order Linear PDEs Using Finite Difference Method (FDM)</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Lab Session 2: Solving First-Order Linear PDEs Using Finite Difference Method (FDM)</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="theoretical-background" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="theoretical-background"><span class="header-section-number">3.1</span> Theoretical Background</h2>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/xoNdZMIiTbc?si=tfu1joIpKh8UX2th" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
</section>
<section id="experiment-2-1d-wave-equation-the-advection-equation" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="experiment-2-1d-wave-equation-the-advection-equation"><span class="header-section-number">3.2</span> Experiment 2: 1D Wave Equation (The Advection Equation)</h2>
<p>While Experiment 1 dealt with basic <code>python</code> programming and solution of a <em>parabolic</em> PDE (diffusion), this experiment focuses on a <em>hyperbolic</em> PDE, which describes phenomena that propagate, like waves. We will solve the <strong>1D Linear Advection Equation</strong>, a fundamental model for wave motion.</p>
<p><strong>Governing Equation:</strong> <span class="math display">\[ \frac{\partial u}{\partial t} + c \frac{\partial u}{\partial x} = 0 \]</span></p>
<p>Here, <code>u(x, t)</code> is the quantity that is moving (e.g., the height of a water wave or the stress in a rod), <code>x</code> is position, <code>t</code> is time, and <code>c</code> is the constant speed at which the wave travels.</p>
<section id="aim" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="aim"><span class="header-section-number">3.2.1</span> Aim</h3>
<p>To solve the one-dimensional wave equation using the <strong>Upwind Method</strong> and compare the numerical result with the initial condition.</p>
</section>
<section id="objectives" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="objectives"><span class="header-section-number">3.2.2</span> Objectives</h3>
<ul>
<li>To learn how to solve partial differential equations using numerical methods.</li>
<li>To understand and apply the Finite Difference Method for hyperbolic equations.</li>
<li>To observe how a wave profile moves with time.</li>
<li>To write and run a Python program for the simulation.</li>
</ul>
</section>
<section id="the-upwind-method-algorithm" class="level3" data-number="3.2.3">
<h3 data-number="3.2.3" class="anchored" data-anchor-id="the-upwind-method-algorithm"><span class="header-section-number">3.2.3</span> The Upwind Method Algorithm</h3>
<p>The “upwind” name comes from the fact that for a wave moving to the right (c &gt; 0), we use information from the “upwind” direction (the left side, <code>i-1</code>) to determine the state at the next time step.</p>
<ol type="1">
<li><strong>Discretize Domain:</strong> Set the number of space points (<code>nx</code>) and time steps (<code>nt</code>). Define the domain length (<code>Lx</code>) and total time (<code>T</code>). Calculate the step sizes <span class="math inline">\(dx = \dfrac{Lx}{(nx - 1)}\)</span> and <span class="math inline">\(dt = \dfrac{T}{nt}\)</span>.</li>
<li><strong>Check Stability (CFL Condition):</strong> Compute the Courant-Friedrichs-Lewy (CFL) number, <span class="math inline">\(\lambda = c \frac{\Delta t}{\Delta x}\)</span>. For the explicit upwind scheme to be stable, we must have <span class="math inline">\(\lambda \le 1\)</span>. This means the numerical wave speed (<code>dx/dt</code>) must be faster than the physical wave speed (<code>c</code>), so the calculation can “keep up” with the phenomenon.</li>
<li><strong>Set Initial Condition:</strong> Define the initial shape of the wave, <code>u(x, 0)</code>.</li>
<li><strong>Time Marching Loop:</strong> For each time step <code>n</code>, iterate through all spatial points <code>i</code> and apply the upwind formula to find the wave’s new state <code>u_new</code>. The discretized formula is: <span class="math display">\[ u_i^{n+1} = u_i^n - \lambda (u_i^n - u_{i-1}^n) \]</span></li>
<li><strong>Update:</strong> Set <code>u = u_new</code>.</li>
<li><strong>Visualize:</strong> Plot the final wave profile against the initial one.</li>
</ol>
</section>
<section id="case-study-exponential-decay-wave" class="level3" data-number="3.2.4">
<h3 data-number="3.2.4" class="anchored" data-anchor-id="case-study-exponential-decay-wave"><span class="header-section-number">3.2.4</span> Case Study: Exponential Decay Wave</h3>
<p>Let’s simulate the equation <span class="math inline">\(\frac{\partial u}{\partial t} + \frac{\partial u}{\partial x} = 0\)</span> (so <code>c=1</code>) with the initial condition <span class="math inline">\(u(x, 0) = e^{-x}\)</span>.</p>
<div id="cell-fig-upwind-exp" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 1. Discretize Domain ---</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>nx <span class="op">=</span> <span class="dv">50</span>       <span class="co"># Number of spatial points</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>nt <span class="op">=</span> <span class="dv">30</span>       <span class="co"># Number of time steps</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>Lx <span class="op">=</span> <span class="fl">5.0</span>      <span class="co"># Domain length</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> <span class="fl">2.0</span>       <span class="co"># Total time</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>dx <span class="op">=</span> Lx <span class="op">/</span> (nx <span class="op">-</span> <span class="dv">1</span>)  <span class="co"># Spatial step</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> T <span class="op">/</span> nt         <span class="co"># Time step</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> <span class="fl">1.0</span>       <span class="co"># Wave speed</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 2. Check Stability ---</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>lambda_ <span class="op">=</span> c <span class="op">*</span> dt <span class="op">/</span> dx</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"CFL Number (lambda) = </span><span class="sc">{</span>lambda_<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> lambda_ <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Warning: CFL condition not met. The solution may be unstable!"</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 3. Set Initial Condition ---</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, Lx, nx)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> np.exp(<span class="op">-</span>x)  <span class="co"># u(x, 0) = e^(-x)</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>u_initial <span class="op">=</span> u.copy() <span class="co"># Save the initial state for plotting</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 4. &amp; 5. Time Marching Loop ---</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(nt):</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    u_old <span class="op">=</span> u.copy()</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Apply upwind formula to all interior points</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, nx):</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>        u[i] <span class="op">=</span> u_old[i] <span class="op">-</span> lambda_ <span class="op">*</span> (u_old[i] <span class="op">-</span> u_old[i<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 6. Visualize ---</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>plt.plot(x, u_initial, <span class="st">'r--'</span>, label<span class="op">=</span><span class="st">"Initial Condition at t=0"</span>)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>plt.plot(x, u, <span class="st">'b-'</span>, marker<span class="op">=</span><span class="st">'o'</span>, markersize<span class="op">=</span><span class="dv">4</span>, label<span class="op">=</span><span class="ss">f"Numerical Solution at t=</span><span class="sc">{</span>T<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Position (x)"</span>)</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"u(x, t)"</span>)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Solution of 1D Advection Equation (Upwind Scheme)"</span>)</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>CFL Number (lambda) = 0.6533</code></pre>
</div>
<div class="cell-output cell-output-display">
<div id="fig-upwind-exp" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-upwind-exp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02-pde-numerical_files/figure-html/fig-upwind-exp-output-2.png" width="812" height="523" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-upwind-exp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.1: Numerical solution of the advection equation with an exponential initial condition using the Upwind scheme.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="result-and-discussion" class="level3" data-number="3.2.5">
<h3 data-number="3.2.5" class="anchored" data-anchor-id="result-and-discussion"><span class="header-section-number">3.2.5</span> Result and Discussion</h3>
<p>The numerical solution using the Upwind Method for the initial condition <span class="math inline">\(u(x,0)=e^{-x}\)</span> shows the wave propagating to the right, as expected. The Courant number <span class="math inline">\(\lambda=c\dfrac{dt}{dx}\)</span> was maintained within the stability range (<span class="math inline">\(\lambda\leq 1\)</span>), ensuring a stable and oscillation-free result. However, we can observe two key phenomena characteristic of this first-order scheme:</p>
<ul>
<li>Numerical Diffusion: The final wave shape is “smeared” or smoothed out compared to the initial condition. The sharp features are dampened. This is artificial damping introduced by the numerical method itself.</li>
<li>Amplitude Decay: The peak of the wave seems to decrease slightly.</li>
</ul>
<p>Despite these inaccuracies, the upwind scheme is computationally simple and robust, making it effective for simulating basic convection phenomena where the general transport behavior is more important than preserving the exact shape of the wave.</p>
</section>
</section>
<section id="application-problem-stress-wave-in-a-rod" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="application-problem-stress-wave-in-a-rod"><span class="header-section-number">3.3</span> Application Problem: Stress Wave in a Rod</h2>
<p>In mechanical systems, like long slender rods or beams, stress waves travel due to sudden loads or impacts. When a rod is struck at one end, a wave of stress and strain travels along its length. This can be modeled using the same 1D advection equation.</p>
<p><strong>Task:</strong> Modify the code above to simulate a “square pulse” stress wave.</p>
<p>Governing Equation: <span class="math inline">\(\frac{\partial u}{\partial t}+c\frac{\partial u}{\partial t}=0\)</span>.</p>
<p>Initial Condition: A square pulse representing a localized impact.</p>
<p><span class="math display">\[u(x,0)=\begin{cases} 1&amp;; 0.4\leq x\leq 0.6\\ 0&amp;; \text{otherwise}\end{cases}\]</span></p>
<p>Your Challenge:</p>
<ul>
<li>Copy the Python code block from the previous example.</li>
<li>Change the line that sets the initial condition u to create the square pulse described above. Hint: You can use NumPy’s logical indexing. For example: <code>u[ (x &gt;= 0.4) &amp; (x &lt;= 0.6) ] = 1.0</code>. You will need to initialize u as an array of zeros first: <code>u = np.zeros(nx)</code>.</li>
<li>Re-run the simulation. Observe how the sharp corners of the square wave are smoothed out due to numerical diffusion.</li>
</ul>
<section id="solution-to-the-application-problem-stress-wave-in-a-rod" class="level4" data-number="3.3.0.1">
<h4 data-number="3.3.0.1" class="anchored" data-anchor-id="solution-to-the-application-problem-stress-wave-in-a-rod"><span class="header-section-number">3.3.0.1</span> Solution to the Application Problem: Stress Wave in a Rod</h4>
<p>Here, we apply the same Upwind Method to the practical problem of a stress wave propagating through a mechanical rod. The initial condition is a square pulse, which could represent a short, sharp impact from a hammer strike on a specific section of the rod.</p>
<blockquote class="blockquote">
<p>Python Implementation</p>
</blockquote>
<p>The core algorithm remains the same. The only change is in how we define the initial condition <code>u(x, 0)</code>.</p>
<div id="cell-fig-upwind-square" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 1. Discretize Domain (same as before) ---</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>nx <span class="op">=</span> <span class="dv">101</span>      <span class="co"># Increased points for better resolution</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>nt <span class="op">=</span> <span class="dv">50</span>       <span class="co"># Increased time steps</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>Lx <span class="op">=</span> <span class="fl">2.0</span>      <span class="co"># Longer domain to see the wave travel</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> <span class="fl">1.0</span>       <span class="co"># Total time</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>dx <span class="op">=</span> Lx <span class="op">/</span> (nx <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> T <span class="op">/</span> nt</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> <span class="fl">1.0</span>       <span class="co"># Wave speed</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 2. Check Stability ---</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>lambda_ <span class="op">=</span> c <span class="op">*</span> dt <span class="op">/</span> dx</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"CFL Number (lambda) = </span><span class="sc">{</span>lambda_<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> lambda_ <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Warning: CFL condition not met. The solution may be unstable!"</span>)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 3. Set Initial Condition: Square Pulse ---</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, Lx, nx)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize u as an array of zeros</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> np.zeros(nx)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the pulse region to 1.0 using logical indexing</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>u[(x <span class="op">&gt;=</span> <span class="fl">0.4</span>) <span class="op">&amp;</span> (x <span class="op">&lt;=</span> <span class="fl">0.6</span>)] <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the initial state for plotting</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>u_initial <span class="op">=</span> u.copy()</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 4. &amp; 5. Time Marching Loop (same as before) ---</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(nt):</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    u_old <span class="op">=</span> u.copy()</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, nx):</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>        u[i] <span class="op">=</span> u_old[i] <span class="op">-</span> lambda_ <span class="op">*</span> (u_old[i] <span class="op">-</span> u_old[i<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 6. Visualize ---</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the analytical solution's position for comparison</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a><span class="co"># The pulse should have moved by a distance of c*T</span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>analytical_x_start <span class="op">=</span> <span class="fl">0.4</span> <span class="op">+</span> c <span class="op">*</span> T</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>analytical_x_end <span class="op">=</span> <span class="fl">0.6</span> <span class="op">+</span> c <span class="op">*</span> T</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>plt.plot(x, u_initial, <span class="st">'r--'</span>, label<span class="op">=</span><span class="st">"Initial Condition (t=0)"</span>)</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>plt.plot(x, u, <span class="st">'b-'</span>, marker<span class="op">=</span><span class="st">'.'</span>, markersize<span class="op">=</span><span class="dv">5</span>, label<span class="op">=</span><span class="ss">f"Numerical Solution (t=</span><span class="sc">{</span>T<span class="sc">}</span><span class="ss">)"</span>)</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the theoretical "perfect" wave for comparison</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>plt.plot([analytical_x_start, analytical_x_end], [<span class="dv">1</span>, <span class="dv">1</span>], <span class="st">'g:'</span>, linewidth<span class="op">=</span><span class="dv">3</span>, label<span class="op">=</span><span class="ss">f'Analytical Position (t=</span><span class="sc">{</span>T<span class="sc">}</span><span class="ss">)'</span>)</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>plt.plot([analytical_x_start, analytical_x_start], [<span class="dv">0</span>, <span class="dv">1</span>], <span class="st">'g:'</span>, linewidth<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>plt.plot([analytical_x_end, analytical_x_end], [<span class="dv">0</span>, <span class="dv">1</span>], <span class="st">'g:'</span>, linewidth<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Position along rod (x)"</span>)</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Stress/Strain (u)"</span>)</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="op">-</span><span class="fl">0.2</span>, <span class="fl">1.2</span>) <span class="co"># Set y-axis limits for better visualization</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Simulation of a Square Stress Wave"</span>)</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>CFL Number (lambda) = 1.0000</code></pre>
</div>
<div class="cell-output cell-output-display">
<div id="fig-upwind-square" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-upwind-square-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02-pde-numerical_files/figure-html/fig-upwind-square-output-2.png" width="823" height="523" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-upwind-square-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.2: Propagation of a square pulse stress wave, showing significant numerical diffusion.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="discussion-of-the-square-pulse-result" class="level4" data-number="3.3.0.2">
<h4 data-number="3.3.0.2" class="anchored" data-anchor-id="discussion-of-the-square-pulse-result"><span class="header-section-number">3.3.0.2</span> Discussion of the Square Pulse Result</h4>
<p><em>Wave Propagation:</em> The primary success of the simulation is clearly visible: the pulse has moved to the right. The leading edge of the numerical solution is centered around the correct analytical position (x = 1.4 for the start of the pulse), confirming that the model correctly captures the fundamental advection behavior at speed c=1 over time T=1.</p>
<p><em>Numerical Diffusion:</em> The most striking feature of the result is the severe smoothing of the square pulse. The sharp, vertical edges of the initial condition have been transformed into gentle slopes. The flat top of the pulse has become rounded and its peak amplitude has decreased from 1.0 to approximately 0.75. This is a classic and pronounced example of numerical diffusion, an error inherent in the first-order upwind scheme. The scheme struggles to resolve sharp gradients (discontinuities), so it effectively “smears” them out over several grid points.</p>
<p><em>Practical Implications:</em> In a real engineering scenario, if we needed to know the exact peak stress and its precise location, this simple method would be inadequate. The predicted peak stress is significantly lower than the actual initial stress, which could lead to an incorrect safety assessment.</p>
<p><em>Improving the Model:</em> While the upwind scheme is simple, its diffusive nature is a major drawback for problems requiring high accuracy. To improve the result and preserve the sharpness of the wave, engineers would use:</p>
<ul>
<li>Higher-Order Schemes: Methods like the Lax-Wendroff scheme or flux-limiter methods are designed to be less diffusive and capture sharp fronts more accurately.</li>
<li>Finer Grid: Reducing dx and dt (while keeping lambda stable) can decrease the amount of diffusion, but at a significant computational cost.</li>
</ul>
</section>
<section id="result" class="level4" data-number="3.3.0.3">
<h4 data-number="3.3.0.3" class="anchored" data-anchor-id="result"><span class="header-section-number">3.3.0.3</span> Result</h4>
<p>The application simulation successfully models the physical propagation of a stress wave. However, it also serves as a crucial lesson in computational engineering: every numerical method has inherent errors and limitations. The Upwind Method, while stable and simple, introduces significant numerical diffusion that must be considered when interpreting the results.</p>
<hr>
</section>
</section>
<section id="id-heat-equation--theoretical-background" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="id-heat-equation--theoretical-background"><span class="header-section-number">3.4</span> ID Heat Equation- Theoretical Background</h2>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/i8rnEl8O-r0?si=cB82MUHLk7RYTSzi" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
</section>
<section id="experiment-3-solving-the-1d-heat-equation" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="experiment-3-solving-the-1d-heat-equation"><span class="header-section-number">3.5</span> Experiment 3: Solving the 1D Heat Equation</h2>
<p>This experiment introduces the numerical solution of a <em>parabolic</em> partial differential equation: the one-dimensional heat equation. This equation is fundamental to understanding diffusion processes, not just in heat transfer but also in chemical concentration gradients and other physical phenomena.</p>
<section id="aim-1" class="level3" data-number="3.5.1">
<h3 data-number="3.5.1" class="anchored" data-anchor-id="aim-1"><span class="header-section-number">3.5.1</span> Aim</h3>
<p>To solve the one-dimensional heat conduction equation using the <em>Finite Difference Method (explicit scheme)</em> in <code>Python</code> and to visualize the temperature distribution over time.</p>
</section>
<section id="objectives-1" class="level3" data-number="3.5.2">
<h3 data-number="3.5.2" class="anchored" data-anchor-id="objectives-1"><span class="header-section-number">3.5.2</span> Objectives</h3>
<ul>
<li>To understand the physical interpretation of the one-dimensional heat equation.</li>
<li>To discretize the heat equation using the <em>Forward Time Centred Space (FTCS)</em> scheme.</li>
<li>To implement the finite difference method in <code>Python</code>.</li>
<li>To analyze the stability condition required for this numerical method.</li>
<li>To visualize the temperature profiles at different time levels.</li>
</ul>
</section>
<section id="governing-equation-and-discretization" class="level3" data-number="3.5.3">
<h3 data-number="3.5.3" class="anchored" data-anchor-id="governing-equation-and-discretization"><span class="header-section-number">3.5.3</span> Governing Equation and Discretization</h3>
<p>The one-dimensional heat equation describes how temperature <code>u</code> evolves at a position <code>x</code> and time <code>t</code>. It is given by:</p>
<p><span class="math display">\[
\frac{\partial u}{\partial t} = \alpha \frac{\partial^2 u}{\partial x^2}
\]</span></p>
<p>where <span class="math inline">\(\alpha\)</span> is the thermal diffusivity of the material, a constant that indicates how quickly the material conducts heat.</p>
<p>To solve this numerically, we use the <em>FTCS</em> method. We approximate the derivatives with finite differences: * <em>Time Derivative (Forward Difference):</em> <span class="math inline">\(\frac{\partial u}{\partial t} \approx \frac{u_i^{n+1} - u_i^n}{\Delta t}\)</span> * <em>Space Derivative (Centred Difference):</em> <span class="math inline">\(\frac{\partial^2 u}{\partial x^2} \approx \frac{u_{i+1}^n - 2u_i^n + u_{i-1}^n}{(\Delta x)^2}\)</span></p>
<p>Here, the superscript <code>n</code> denotes the time level and the subscript <code>i</code> denotes the spatial grid point. Substituting these into the governing equation and rearranging for the future temperature <span class="math inline">\(u_i^{n+1}\)</span>, we get the explicit update formula.</p>
</section>
<section id="algorithm" class="level3" data-number="3.5.4">
<h3 data-number="3.5.4" class="anchored" data-anchor-id="algorithm"><span class="header-section-number">3.5.4</span> Algorithm</h3>
<ol type="1">
<li><p><strong>Initialize Parameters:</strong> Set the values for the rod length <code>L</code>, total simulation time <code>T</code>, number of spatial nodes <span class="math inline">\(n_x\)</span>, number of time steps <span class="math inline">\(n_t\)</span>, and thermal diffusivity <span class="math inline">\(\alpha\)</span>.</p></li>
<li><p><strong>Discretize the Domain:</strong> Calculate the step sizes for space and time.</p>
<ul>
<li>Space step: <span class="math inline">\(\Delta x = \frac{L}{n_x - 1}\)</span></li>
<li>Time step: <span class="math inline">\(\Delta t = \frac{T}{n_t}\)</span></li>
</ul></li>
<li><p><strong>Check Stability Condition:</strong> Calculate the stability parameter, <code>r</code>. For the FTCS scheme to be stable and produce a physically realistic result, this value <strong>must be less than or equal to 0.5</strong>. <span class="math display">\[
r = \frac{\alpha \Delta t}{(\Delta x)^2} \le 0.5
\]</span></p></li>
<li><p><strong>Set Initial and Boundary Conditions:</strong></p>
<ul>
<li>Define the initial temperature distribution along the rod, <span class="math inline">\(u(x, 0)\)</span>.</li>
<li>Apply boundary conditions. In this case, we use <strong>Dirichlet boundary conditions</strong>, which means the temperature at the ends of the rod is fixed for all time (e.g., <span class="math inline">\(u(0, t) = u(L, t) = 0\)</span>).</li>
</ul></li>
<li><p><strong>Iterate Over Time:</strong> For each time step <code>n</code>, loop through all the <em>interior</em> spatial points <code>i</code> and update their temperature using the FTCS formula: <span class="math display">\[
u_i^{n+1} = u_i^n + r \left( u_{i+1}^n - 2u_i^n + u_{i-1}^n \right)
\]</span></p></li>
<li><p><strong>Output and Visualization:</strong> Store the temperature profiles at different time intervals and plot them to visualize the heat diffusion process.</p></li>
</ol>
</section>
<section id="sample-problem-and-python-implementation" class="level3" data-number="3.5.5">
<h3 data-number="3.5.5" class="anchored" data-anchor-id="sample-problem-and-python-implementation"><span class="header-section-number">3.5.5</span> Sample Problem and <code>Python</code> Implementation</h3>
<p><strong>Problem:</strong> Solve the 1D heat equation on a rod of length L=1.0 m with the following conditions: The temperature is zero everywhere except at the very center, where an initial “heat pulse” of 100°C is applied. The ends of the rod are kept at a constant 0°C for all time.</p>
<div id="cell-fig-heat-equation-explicit" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 1. Initialize Parameters ---</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> <span class="fl">1.0</span>           <span class="co"># Length of the rod (meters)</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> <span class="fl">0.1</span>           <span class="co"># Total simulation time (seconds)</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>nx <span class="op">=</span> <span class="dv">21</span>           <span class="co"># Number of spatial grid points (use an odd number for a perfect center)</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>nt <span class="op">=</span> <span class="dv">1000</span>         <span class="co"># Number of time steps</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="fl">0.01</span>      <span class="co"># Thermal diffusivity (e.g., for copper)</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 2. Discretize the Domain ---</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>dx <span class="op">=</span> L <span class="op">/</span> (nx <span class="op">-</span> <span class="dv">1</span>)             <span class="co"># Space step size</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> T <span class="op">/</span> nt                   <span class="co"># Time step size</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 3. Check Stability Condition ---</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> alpha <span class="op">*</span> dt <span class="op">/</span> dx<span class="op">**</span><span class="dv">2</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Space step dx = </span><span class="sc">{</span>dx<span class="sc">:.4f}</span><span class="ss"> m"</span>)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Time step dt = </span><span class="sc">{</span>dt<span class="sc">:.4f}</span><span class="ss"> s"</span>)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Stability parameter r = </span><span class="sc">{</span>r<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> r <span class="op">&gt;</span> <span class="fl">0.5</span>:</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">--- WARNING: STABILITY CONDITION r &gt; 0.5 NOT MET! ---"</span>)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"The solution is likely to be unstable and blow up."</span>)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Stability condition r &lt;= 0.5 is satisfied."</span>)</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 4. Set Initial and Boundary Conditions ---</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Spatial grid</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, L, nx)</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial condition: temperature distribution is zero everywhere...</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> np.zeros(nx)</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a><span class="co"># ...except for a pulse at the center.</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>u[<span class="bu">int</span>((nx <span class="op">-</span> <span class="dv">1</span>) <span class="op">/</span> <span class="dv">2</span>)] <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Boundary conditions u(0,t)=0 and u(L,t)=0 are enforced by the loop range (1, nx-1)</span></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 5. &amp; 6. Time-stepping and Output ---</span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a><span class="co"># To store results at different time steps for plotting</span></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>u_snapshots <span class="op">=</span> [u.copy()]</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>snapshot_interval <span class="op">=</span> <span class="dv">200</span> <span class="co"># Store a snapshot every 200 time steps</span></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(nt):</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>    u_old <span class="op">=</span> u.copy()</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Loop over interior points to apply the FTCS formula</span></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, nx <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>        u[i] <span class="op">=</span> u_old[i] <span class="op">+</span> r <span class="op">*</span> (u_old[i<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span> <span class="dv">2</span><span class="op">*</span>u_old[i] <span class="op">+</span> u_old[i<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Store a snapshot of the solution at specified intervals</span></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (n <span class="op">+</span> <span class="dv">1</span>) <span class="op">%</span> snapshot_interval <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>        u_snapshots.append(u.copy())</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Plotting the results ---</span></span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, u_snap <span class="kw">in</span> <span class="bu">enumerate</span>(u_snapshots):</span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>    time <span class="op">=</span> i <span class="op">*</span> snapshot_interval <span class="op">*</span> dt</span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>    plt.plot(x, u_snap, label<span class="op">=</span><span class="ss">f't = </span><span class="sc">{</span>time<span class="sc">:.2f}</span><span class="ss"> s'</span>)</span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Position along rod (x)'</span>)</span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Temperature (°C)'</span>)</span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'1D Heat Equation: Explicit FTCS Method'</span>)</span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Space step dx = 0.0500 m
Time step dt = 0.0001 s
Stability parameter r = 0.0004

Stability condition r &lt;= 0.5 is satisfied.</code></pre>
</div>
<div class="cell-output cell-output-display">
<div id="fig-heat-equation-explicit" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-heat-equation-explicit-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02-pde-numerical_files/figure-html/fig-heat-equation-explicit-output-2.png" width="816" height="523" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-heat-equation-explicit-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.3: Diffusion of a central heat pulse over time, calculated with the FTCS explicit method.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="application-challenge-heat-dissipation-in-a-longer-rod" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="application-challenge-heat-dissipation-in-a-longer-rod"><span class="header-section-number">3.6</span> Application Challenge: Heat Dissipation in a Longer Rod</h2>
<p>Now, let’s apply what you’ve learned to a new set of physical parameters. This exercise simulates heat dissipation in a longer structural beam with a more intense initial heat source.</p>
<blockquote class="blockquote">
<p>Your Task</p>
</blockquote>
<p>Simulate the 1D heat equation on a rod with the following new conditions:</p>
<ul>
<li><em>Rod Length (L):</em> 3.2 meters</li>
<li><em>Initial Condition:</em> The temperature is 0°C everywhere except for a single point at the very center, which has an intense initial temperature of <em>300°C</em>.</li>
<li><em>Boundary Conditions:</em> The ends of the rod are maintained at 0°C (Dirichlet BC).</li>
<li><em>Material:</em> Assume the same thermal diffusivity, <span class="math inline">\(\alpha = 0.01\)</span>.</li>
<li><em>Simulation Time (T):</em> Run the simulation for a longer time, <code>T = 2.0</code> seconds, to observe more significant diffusion.</li>
</ul>
<blockquote class="blockquote">
<p>The Challenge</p>
</blockquote>
<ol type="1">
<li>Copy the <code>Python</code> code from the previous example.</li>
<li>Modify the parameter values (<code>L</code>, <code>T</code>, and the initial temperature pulse).</li>
<li><em>Crucially</em>, after changing <code>L</code> and <code>T</code>, you must <em>re-calculate the stability parameter <code>r</code></em>. If <code>r &gt; 0.5</code>, the simulation will fail! You will need to adjust either <code>nx</code> (number of space points) or <code>nt</code> (number of time steps) to bring <code>r</code> back into the stable region (<span class="math inline">\(\le 0.5\)</span>). The goal is to find a stable combination.</li>
</ol>
<blockquote class="blockquote">
<p>Hint: The stability parameter is <span class="math inline">\(r = \frac{\alpha \Delta t}{(\Delta x)^2}\)</span>.</p>
</blockquote>
<ul>
<li>If your <code>r</code> value is too high, you have two options to decrease it:</li>
<li><em>Increase <code>nt</code>:</em> This makes the time step <code>Δt</code> smaller, which is the most direct way to lower <code>r</code>.</li>
<li><em>Decrease <code>nx</code>:</em> This makes the space step <code>Δx</code> larger. While this also works, it reduces the spatial resolution of your simulation.</li>
</ul>
<p>Try increasing <code>nt</code> first. A good starting point would be to double it until <code>r</code> is stable.</p>
<blockquote class="blockquote">
<p>Solution to the Application Challenge</p>
</blockquote>
<p>Here is the complete Python code implementing the solution for the new parameters. The key is adjusting <code>nt</code> to ensure stability.</p>
<div id="cell-fig-heat-challenge" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 1. Initialize MODIFIED Parameters ---</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> <span class="fl">3.2</span>           <span class="co"># New Length of the rod (meters)</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> <span class="fl">2.0</span>           <span class="co"># New Total simulation time (seconds)</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>nx <span class="op">=</span> <span class="dv">51</span>           <span class="co"># Number of spatial grid points (odd for a center)</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># nt must be adjusted for stability. Let's start with a high value.</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>nt <span class="op">=</span> <span class="dv">8000</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="fl">0.01</span>      <span class="co"># Thermal diffusivity</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 2. Discretize the Domain ---</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>dx <span class="op">=</span> L <span class="op">/</span> (nx <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> T <span class="op">/</span> nt</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 3. Check Stability Condition ---</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> alpha <span class="op">*</span> dt <span class="op">/</span> dx<span class="op">**</span><span class="dv">2</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"--- Challenge Parameters ---"</span>)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Rod Length L = </span><span class="sc">{</span>L<span class="sc">}</span><span class="ss"> m"</span>)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Space step dx = </span><span class="sc">{</span>dx<span class="sc">:.4f}</span><span class="ss"> m"</span>)</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Time step dt = </span><span class="sc">{</span>dt<span class="sc">:.6f}</span><span class="ss"> s"</span>)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Stability parameter r = </span><span class="sc">{</span>r<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> r <span class="op">&gt;</span> <span class="fl">0.5</span>:</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>    required_nt <span class="op">=</span> (alpha <span class="op">*</span> T <span class="op">*</span> (nx <span class="op">-</span> <span class="dv">1</span>)<span class="op">**</span><span class="dv">2</span>) <span class="op">/</span> (<span class="fl">0.5</span> <span class="op">*</span> L<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">--- WARNING: STABILITY FAILED (r &gt; 0.5) ---"</span>)</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"With nx=</span><span class="sc">{</span>nx<span class="sc">}</span><span class="ss">, you need at least nt = </span><span class="sc">{</span><span class="bu">int</span>(np.ceil(required_nt))<span class="sc">}</span><span class="ss"> to achieve stability."</span>)</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Stability condition r &lt;= 0.5 is satisfied."</span>)</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 4. Set Initial and Boundary Conditions ---</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, L, nx)</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> np.zeros(nx)</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the new initial temperature pulse at the center</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>u[<span class="bu">int</span>((nx <span class="op">-</span> <span class="dv">1</span>) <span class="op">/</span> <span class="dv">2</span>)] <span class="op">=</span> <span class="fl">300.0</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 5. &amp; 6. Time-stepping and Output ---</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>u_snapshots <span class="op">=</span> [u.copy()]</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>snapshot_interval <span class="op">=</span> nt <span class="op">//</span> <span class="dv">4</span> <span class="co"># Store 4 snapshots over the total time</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(nt):</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>    u_old <span class="op">=</span> u.copy()</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, nx <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>        u[i] <span class="op">=</span> u_old[i] <span class="op">+</span> r <span class="op">*</span> (u_old[i] <span class="op">+</span> u_old[i<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> <span class="dv">2</span><span class="op">*</span>u_old[i]) <span class="co"># Corrected formula</span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (n <span class="op">+</span> <span class="dv">1</span>) <span class="op">%</span> snapshot_interval <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>        u_snapshots.append(u.copy())</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Plotting the results ---</span></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, u_snap <span class="kw">in</span> <span class="bu">enumerate</span>(u_snapshots):</span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>    time <span class="op">=</span> i <span class="op">*</span> snapshot_interval <span class="op">*</span> dt</span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The first plot is the initial condition at t=0</span></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>        time <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>    plt.plot(x, u_snap, label<span class="op">=</span><span class="ss">f't = </span><span class="sc">{</span>time<span class="sc">:.2f}</span><span class="ss"> s'</span>)</span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Position along rod (x) [m]'</span>)</span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Temperature (°C)'</span>)</span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Challenge: Heat Dissipation in a 3.2m Rod'</span>)</span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>--- Challenge Parameters ---
Rod Length L = 3.2 m
Space step dx = 0.0640 m
Time step dt = 0.000250 s
Stability parameter r = 0.0006

Stability condition r &lt;= 0.5 is satisfied.</code></pre>
</div>
<div class="cell-output cell-output-display">
<div id="fig-heat-challenge" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-heat-challenge-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02-pde-numerical_files/figure-html/fig-heat-challenge-output-2.png" width="816" height="523" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-heat-challenge-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.4: Heat diffusion from a 300°C pulse in a 3.2m rod over 2.0 seconds.
</figcaption>
</figure>
</div>
</div>
</div>
<section id="results-and-discussion-of-the-challenge" class="level4" data-number="3.6.0.1">
<h4 data-number="3.6.0.1" class="anchored" data-anchor-id="results-and-discussion-of-the-challenge"><span class="header-section-number">3.6.0.1</span> Results and Discussion of the Challenge</h4>
<ul>
<li><p>Stability Management: The primary challenge was maintaining stability. By increasing the rod length L significantly, the space step Δx became larger. Since Δx is squared in the denominator of the stability parameter r, this drastically increased the tendency for r to be large. To counteract this, the number of time steps nt had to be substantially increased (to 8000 in this solution) to make Δt small enough to keep r below the 0.5 threshold. This is a critical lesson in numerical methods: changing one parameter often necessitates adjusting others to maintain a valid simulation.</p></li>
<li><p>Slower Diffusion: Comparing the plots to the first example, we can see that even though the simulation ran for a much longer time (2.0s vs 0.1s), the heat has not reached the ends of the rod. This is because the rod is much longer (3.2m vs 1.0m). Heat diffusion is a relatively slow process, and the increased distance means it takes significantly more time for the thermal energy to propagate.</p></li>
<li><p>Amplitude and Profile: The initial peak temperature of 300°C drops very quickly, as the heat immediately begins to flow into the adjacent, colder sections of the rod. The resulting temperature profiles are wider and flatter compared to the first example at equivalent early stages, which is characteristic of diffusion over a larger domain.</p></li>
</ul>
<p><strong>Result</strong></p>
<p>The overall behavior remains physically consistent, demonstrating the robustness of the FTCS method when its stability condition is respected.</p>
<hr>
</section>
</section>
<section id="second-order-1d-wave-equation--theoretical-background" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="second-order-1d-wave-equation--theoretical-background"><span class="header-section-number">3.7</span> Second order 1D Wave Equation- Theoretical Background</h2>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/9TQCKWWAVjM?si=RYfufQo0Jb0NJP4y" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
</section>
<section id="experiment-4-the-second-order-1d-wave-equation" class="level2" data-number="3.8">
<h2 data-number="3.8" class="anchored" data-anchor-id="experiment-4-the-second-order-1d-wave-equation"><span class="header-section-number">3.8</span> Experiment 4: The Second-Order 1D Wave Equation</h2>
<p>This experiment moves from first-order to second-order hyperbolic PDEs by tackling the classic one-dimensional wave equation. This equation models a vast range of physical phenomena, including the vibrations of a guitar string, pressure waves in a tube, and the propagation of electromagnetic waves in a transmission line.</p>
<section id="aim-2" class="level3" data-number="3.8.1">
<h3 data-number="3.8.1" class="anchored" data-anchor-id="aim-2"><span class="header-section-number">3.8.1</span> Aim</h3>
<p>To solve the one-dimensional wave equation using the finite difference method with an explicit time-stepping scheme.</p>
</section>
<section id="objectives-2" class="level3" data-number="3.8.2">
<h3 data-number="3.8.2" class="anchored" data-anchor-id="objectives-2"><span class="header-section-number">3.8.2</span> Objectives</h3>
<ul>
<li>To solve the second-order wave equation for a 1D domain with given initial and boundary conditions.</li>
<li>To implement the central difference scheme for both time and space derivatives.</li>
<li>To understand the role of initial displacement and initial velocity.</li>
<li>To simulate wave propagation and reflection and observe how waves evolve over time.</li>
</ul>
</section>
<section id="governing-equation-and-discretization-1" class="level3" data-number="3.8.3">
<h3 data-number="3.8.3" class="anchored" data-anchor-id="governing-equation-and-discretization-1"><span class="header-section-number">3.8.3</span> Governing Equation and Discretization</h3>
<p>The second-order, one-dimensional wave equation is given by: <span class="math display">\[
\frac{\partial^2 u}{\partial t^2} = c^2 \frac{\partial^2 u}{\partial x^2}
\]</span> where <span class="math inline">\(u(x,t)\)</span> is the displacement at position <code>x</code> and time <code>t</code>, and <code>c</code> is the constant wave propagation speed.</p>
<p>To solve this numerically, we use a <strong>central difference</strong> approximation for both derivatives: * <em>Time Derivative:</em> <span class="math inline">\(\frac{\partial^2 u}{\partial t^2} \approx \frac{u_i^{n+1} - 2u_i^n + u_i^{n-1}}{(\Delta t)^2}\)</span> * <em>Space Derivative:</em> <span class="math inline">\(\frac{\partial^2 u}{\partial x^2} \approx \frac{u_{i+1}^n - 2u_i^n + u_{i-1}^n}{(\Delta x)^2}\)</span></p>
<p>Substituting these into the governing equation and solving for the future displacement <span class="math inline">\(u_i^{n+1}\)</span> gives the explicit update formula.</p>
</section>
<section id="algorithm-1" class="level3" data-number="3.8.4">
<h3 data-number="3.8.4" class="anchored" data-anchor-id="algorithm-1"><span class="header-section-number">3.8.4</span> Algorithm</h3>
<ol type="1">
<li><strong>Discretize the Domain:</strong>
<ul>
<li>Divide the spatial domain of length <code>L</code> into discrete points using a step size <span class="math inline">\(\Delta x\)</span>.</li>
<li>Divide the time domain of total duration <code>T</code> using a time step <span class="math inline">\(\Delta t\)</span>.</li>
</ul></li>
<li><strong>Stability Check (CFL Condition):</strong>
<ul>
<li>Calculate the <strong>Courant Number</strong>, <span class="math inline">\(C = \frac{c \Delta t}{\Delta x}\)</span>.</li>
<li>For this explicit scheme to be stable, the Courant number must satisfy <span class="math inline">\(C \le 1\)</span>. If <span class="math inline">\(C &gt; 1\)</span>, the numerical solution will grow without bound and become meaningless.</li>
</ul></li>
<li><strong>Set Initial Conditions:</strong>
<ul>
<li>This is a second-order equation in time, so we need <strong>two</strong> initial conditions:
<ol type="1">
<li>Initial displacement: <span class="math inline">\(u(x, 0) = f(x)\)</span></li>
<li>Initial velocity: <span class="math inline">\(\frac{\partial u}{\partial t}(x, 0) = g(x)\)</span></li>
</ol></li>
</ul></li>
<li><strong>Set Boundary Conditions:</strong>
<ul>
<li>Assume the boundaries of the domain are fixed (e.g., the ends of a guitar string). This is a <strong>Dirichlet boundary condition</strong>: <span class="math inline">\(u(0, t) = u(L, t) = 0\)</span> for all time <code>t</code>.</li>
</ul></li>
<li><strong>Time-stepping Loop:</strong>
<ul>
<li>The update rule requires information from two previous time steps (<code>n</code> and <code>n-1</code>). This poses a problem for the very first step (<code>n=1</code>), as we don’t have a state at <code>n=-1</code>. We use a special formula for the first step derived from the initial velocity condition. For zero initial velocity, this simplifies.</li>
<li>For all subsequent time steps (<code>n &gt; 1</code>), use the main finite difference formula: <span class="math display">\[
u_i^{n+1} = 2u_i^n - u_i^{n-1} + C^2 \left( u_{i+1}^n - 2u_i^n + u_{i-1}^n \right)
\]</span></li>
</ul></li>
<li><strong>Plot and Visualize:</strong>
<ul>
<li>After solving for all time steps, plot the wave’s displacement <code>u(x)</code> at different time instances to observe its motion and reflection.</li>
</ul></li>
</ol>
</section>
<section id="application-problem-and-python-implementation" class="level3" data-number="3.8.5">
<h3 data-number="3.8.5" class="anchored" data-anchor-id="application-problem-and-python-implementation"><span class="header-section-number">3.8.5</span> Application Problem and Python Implementation</h3>
<p><strong>Problem:</strong> The vibration of a stretched string under tension is governed by the 1D wave equation. We are tasked with modeling the vibration of a string of length <code>L=1.0m</code> stretched between two fixed points. The string is given an initial displacement in the shape of a sine wave, <span class="math inline">\(u(x,0) = \sin(\pi x)\)</span>, but <em>zero initial velocity</em>.</p>
<div id="cell-fig-wave-equation-string" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 1. Parameters &amp; Discretization ---</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> <span class="fl">1.0</span>             <span class="co"># Length of the domain (string)</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> <span class="fl">1.0</span>             <span class="co"># Wave speed</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>dx <span class="op">=</span> <span class="fl">0.1</span>            <span class="co"># Spatial step size</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> <span class="fl">0.05</span>           <span class="co"># Time step size</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> <span class="fl">2.0</span>             <span class="co"># Total time (enough for one full reflection)</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 2. Stability Check ---</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>C <span class="op">=</span> c <span class="op">*</span> dt <span class="op">/</span> dx</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Courant Number C = </span><span class="sc">{</span>C<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> C <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"CFL condition (C &lt;= 1) not met. Instability expected."</span>)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"CFL condition is satisfied."</span>)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Grid setup ---</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="dv">0</span>, L <span class="op">+</span> dx, dx)</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>nx <span class="op">=</span> <span class="bu">len</span>(x)</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>nt <span class="op">=</span> <span class="bu">int</span>(T <span class="op">/</span> dt) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a 2D array to store the solution at all time steps</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> np.zeros((nt, nx))</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 3. Initial Conditions ---</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial displacement: u(x, 0) = sin(pi * x)</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>u[<span class="dv">0</span>, :] <span class="op">=</span> np.sin(np.pi <span class="op">*</span> x)</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Special formula for the first time step (n=1) assuming zero initial velocity</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a><span class="co"># u_i^1 = u_i^0 + C^2/2 * (u_{i+1}^0 - 2u_i^0 + u_{i-1}^0)</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>u[<span class="dv">1</span>, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> u[<span class="dv">0</span>, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> C<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> (u[<span class="dv">0</span>, <span class="dv">2</span>:] <span class="op">-</span> <span class="dv">2</span><span class="op">*</span>u[<span class="dv">0</span>, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> u[<span class="dv">0</span>, :<span class="op">-</span><span class="dv">2</span>])</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Boundary conditions u(0,t)=0 and u(L,t)=0 are already handled by slicing [1:-1]</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 5. Time-stepping Loop ---</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, nt <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>    u[n <span class="op">+</span> <span class="dv">1</span>, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> (<span class="dv">2</span> <span class="op">*</span> u[n, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> u[n <span class="op">-</span> <span class="dv">1</span>, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>                      C<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> (u[n, <span class="dv">2</span>:] <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> u[n, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> u[n, :<span class="op">-</span><span class="dv">2</span>]))</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"x</span><span class="ch">\t</span><span class="st">"</span> <span class="op">+</span> <span class="st">"</span><span class="ch">\t</span><span class="st">"</span>.join([<span class="ss">f"u^</span><span class="sc">{</span>n<span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>)]))  <span class="co"># First 5 steps</span></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(nx):</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>    values <span class="op">=</span> <span class="st">"</span><span class="ch">\t</span><span class="st">"</span>.join(<span class="ss">f"</span><span class="sc">{</span>u[n, i]<span class="sc">:.4f}</span><span class="ss">"</span> <span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>))</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>x[i]<span class="sc">:.2f}</span><span class="ch">\t</span><span class="sc">{</span>values<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Optional: plot final wave</span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 6. Plot and Visualize ---</span></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>plt.plot(x, u[<span class="dv">0</span>, :], <span class="st">'r--'</span>, label<span class="op">=</span><span class="st">'Initial (t=0)'</span>)</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Time index for t = T/2</span></span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>mid_time_index <span class="op">=</span> <span class="bu">int</span>(nt <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>plt.plot(x, u[mid_time_index, :], <span class="st">'g:'</span>, label<span class="op">=</span><span class="ss">f'Mid-time (t=</span><span class="sc">{</span>mid_time_index<span class="op">*</span>dt<span class="sc">:.2f}</span><span class="ss">s)'</span>)</span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>plt.plot(x, u[<span class="op">-</span><span class="dv">1</span>, :], <span class="st">'b-'</span>, label<span class="op">=</span><span class="ss">f'Final (t=</span><span class="sc">{</span>T<span class="sc">:.2f}</span><span class="ss">s)'</span>)</span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Position along string (x)'</span>)</span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Displacement (u)'</span>)</span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'1D Wave Equation: Vibrating String Simulation'</span>)</span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Courant Number C = 0.50
CFL condition is satisfied.
x   u^0 u^1 u^2 u^3 u^4
0.00    0.0000  0.0000  0.0000  0.0000  0.0000
0.10    0.3090  0.3052  0.2940  0.2755  0.2504
0.20    0.5878  0.5806  0.5592  0.5241  0.4762
0.30    0.8090  0.7991  0.7697  0.7214  0.6554
0.40    0.9511  0.9394  0.9048  0.8480  0.7705
0.50    1.0000  0.9878  0.9514  0.8917  0.8102
0.60    0.9511  0.9394  0.9048  0.8480  0.7705
0.70    0.8090  0.7991  0.7697  0.7214  0.6554
0.80    0.5878  0.5806  0.5592  0.5241  0.4762
0.90    0.3090  0.3052  0.2940  0.2755  0.2504
1.00    0.0000  0.0000  0.0000  0.0000  0.0000</code></pre>
</div>
<div class="cell-output cell-output-display">
<div id="fig-wave-equation-string" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-wave-equation-string-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02-pde-numerical_files/figure-html/fig-wave-equation-string-output-2.png" width="832" height="523" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-wave-equation-string-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.5: Vibration of a string with an initial sine-wave displacement, showing reflection.
</figcaption>
</figure>
</div>
</div>
</div>
<section id="result-and-discussion-1" class="level4" data-number="3.8.5.1">
<h4 data-number="3.8.5.1" class="anchored" data-anchor-id="result-and-discussion-1"><span class="header-section-number">3.8.5.1</span> Result and Discussion</h4>
<p>The simulation effectively models the behavior of a vibrating string with fixed ends.</p>
<ul>
<li><p>Initial State (t=0): The string starts in its initial sine wave shape, as defined.</p></li>
<li><p>Propagation and Reflection: At the mid-time point (t=1.0s), the wave has traveled, reflected off the fixed boundaries, and become inverted. This is physically accurate: when a wave on a string hits a fixed end, it reflects back with opposite polarity.</p></li>
<li><p>Final State (t=2.0s): After one full period of oscillation, the wave has traveled to both ends, reflected, and returned to its original position and shape, demonstrating the periodic nature of the solution.</p></li>
<li><p>Stability: The CFL number was calculated as <span class="math inline">\(C=0.5\)</span> , which satisfies the stability condition , <span class="math inline">\(C\leq 1\)</span>. This ensures that the solution remains bounded and physically realistic.</p></li>
<li><p>Numerical Dispersion: While not highly prominent in this example due to the smooth initial condition, some slight changes in the wave’s shape might be observed over longer simulation times. This is known as numerical dispersion, an artifact where different frequency components of the wave travel at slightly different speeds in the numerical grid.</p></li>
</ul>
<p><strong>Result</strong></p>
<p>The explicit finite difference method accurately captures the key dynamics of wave propagation and reflection, making it a powerful tool for analyzing such systems.</p>
<hr>
</section>
</section>
</section>
<section id="application-challenge-vibration-in-a-flexible-robot-link" class="level2" data-number="3.9">
<h2 data-number="3.9" class="anchored" data-anchor-id="application-challenge-vibration-in-a-flexible-robot-link"><span class="header-section-number">3.9</span> Application Challenge: Vibration in a Flexible Robot Link</h2>
<p>In modern robotics, lightweight materials are used to create fast and efficient robots. However, these materials are often flexible. When a motor at the base of a robot link starts or stops suddenly, it can induce a longitudinal (compression/expansion) wave that travels down the link, causing vibrations at the end-effector (the robot’s tool or gripper). This vibration can severely impact the robot’s precision.</p>
<p>We can model this phenomenon using the 1D wave equation, where <code>u(x,t)</code> now represents the longitudinal displacement of the material from its resting position.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="sudden-motor-movement.png" class="img-fluid figure-img"></p>
<figcaption>Sudden motor movement</figcaption>
</figure>
</div>
<section id="your-task" class="level4" data-number="3.9.0.1">
<h4 data-number="3.9.0.1" class="anchored" data-anchor-id="your-task"><span class="header-section-number">3.9.0.1</span> Your Task</h4>
<p>Model the vibration in a <strong>2.0-meter long</strong> flexible robot link. * <em>Physical Setup:</em> * <em>Base (x=0):</em> Connected to a motor. We will model a sudden “jolt” by giving the base a brief, sharp displacement and then returning it to zero. * <em>End-Effector (x=L):</em> The end of the link is free to move. This is a <em>Neumann boundary condition</em>, which physically means the stress at the end is zero, or <span class="math inline">\(\frac{\partial u}{\partial x}(L, t) = 0\)</span>. * <em>Initial Conditions:</em> The link is initially at rest. * Initial displacement <span class="math inline">\(u(x,0) = 0\)</span>. * Initial velocity <span class="math inline">\(\frac{\partial u}{\partial t}(x,0) = 0\)</span>. * <strong>Wave Speed:</strong> The speed of sound (and thus stress waves) in this material is <span class="math inline">\(c = 50\)</span> m/s.</p>
</section>
<section id="the-challenge" class="level4" data-number="3.9.0.2">
<h4 data-number="3.9.0.2" class="anchored" data-anchor-id="the-challenge"><span class="header-section-number">3.9.0.2</span> The Challenge</h4>
<ol type="1">
<li><em>Implement a New Boundary Condition:</em> The motor’s jolt can be modeled by forcing the displacement at the base, <code>u[n, 0]</code>, to be a short pulse. For example, a sine pulse for a very short duration at the beginning of the simulation.</li>
<li><em>Implement the “Free End” (Neumann) Boundary:</em> The condition <span class="math inline">\(\frac{\partial u}{\partial x}(L, t) = 0\)</span> can be approximated with a finite difference as <span class="math inline">\(\frac{u_{nx-1}^n - u_{nx-2}^n}{\Delta x} = 0\)</span>, which simplifies to <span class="math inline">\(u_{nx-1}^n = u_{nx-2}^n\)</span>. This means the last point always has the same displacement as the point next to it. You must enforce this at every time step.</li>
<li><em>Analyze the Result:</em> Plot the displacement of the <em>end-effector (<code>u[:, -1]</code>)</em> over time to see how it vibrates in response to the motor’s jolt.</li>
</ol>
</section>
<section id="hints" class="level4" data-number="3.9.0.3">
<h4 data-number="3.9.0.3" class="anchored" data-anchor-id="hints"><span class="header-section-number">3.9.0.3</span> Hints</h4>
<ul>
<li><p><em>Motor Jolt:</em> You can create the motor jolt inside the time-stepping loop. Use an <code>if</code> condition to apply the pulse only for a short time (e.g., when <code>n*dt &lt; pulse_duration</code>). A simple pulse could be <code>u[n, 0] = A * np.sin(omega * n * dt)</code>.</p></li>
<li><p><em>Neumann Boundary:</em> After the main update loop for the interior points, add a line to enforce the free-end condition: <code>u[n + 1, -1] = u[n + 1, -2]</code>. The <code>-1</code> index refers to the last element, and <code>-2</code> refers to the second-to-last.</p></li>
<li><p><em>Stability:</em> With a high wave speed (<code>c=50</code>), you will need a very small time step <code>dt</code> to satisfy the CFL condition (<span class="math inline">\(C \le 1\)</span>). Be prepared to use a large <code>nt</code>.</p></li>
</ul>
</section>
<section id="solution-to-the-robotics-application-challenge" class="level3" data-number="3.9.1">
<h3 data-number="3.9.1" class="anchored" data-anchor-id="solution-to-the-robotics-application-challenge"><span class="header-section-number">3.9.1</span> Solution to the Robotics Application Challenge</h3>
<p>Here is the Python code that models the robot link vibration, incorporating the driving pulse at the base and the free-end boundary condition.</p>
<div id="cell-fig-robot-link-vibration" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 1. Parameters for the Robot Link ---</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> <span class="fl">2.0</span>             <span class="co"># Length of the robot link (m)</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> <span class="fl">50.0</span>            <span class="co"># Wave speed in the material (m/s)</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> <span class="fl">0.15</span>            <span class="co"># Total simulation time (s)</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Discretization - fine grid needed for high wave speed</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>dx <span class="op">=</span> <span class="fl">0.04</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co"># dt must be chosen carefully for stability</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> dx <span class="op">/</span> c <span class="op">*</span> <span class="fl">0.9</span>   <span class="co"># Choose dt based on dx and c to guarantee C=0.9</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>C <span class="op">=</span> c <span class="op">*</span> dt <span class="op">/</span> dx</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"--- Robotics Challenge Parameters ---"</span>)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Wave Speed c = </span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> m/s"</span>)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Courant Number C = </span><span class="sc">{</span>C<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> C <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"CFL condition failed!"</span>)</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Grid setup ---</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="dv">0</span>, L <span class="op">+</span> dx, dx)</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>t_vec <span class="op">=</span> np.arange(<span class="dv">0</span>, T <span class="op">+</span> dt, dt)</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>nx <span class="op">=</span> <span class="bu">len</span>(x)</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>nt <span class="op">=</span> <span class="bu">len</span>(t_vec)</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> np.zeros((nt, nx))</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Motor Jolt Parameters ---</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>pulse_duration <span class="op">=</span> <span class="fl">0.02</span>  <span class="co"># s</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>pulse_amplitude <span class="op">=</span> <span class="fl">0.001</span> <span class="co"># 1 mm jolt</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>pulse_frequency <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> np.pi <span class="op">/</span> pulse_duration</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 5. Time-stepping Loop with New Boundary Conditions ---</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, nt <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Main update for interior points (from 2nd point to 2nd-to-last)</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>    u[n <span class="op">+</span> <span class="dv">1</span>, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> (<span class="dv">2</span> <span class="op">*</span> u[n, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> u[n <span class="op">-</span> <span class="dv">1</span>, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>                      C<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> (u[n, <span class="dv">2</span>:] <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> u[n, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> u[n, :<span class="op">-</span><span class="dv">2</span>]))</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Boundary Condition 1: Motor Jolt at the Base (x=0)</span></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>    current_time <span class="op">=</span> n <span class="op">*</span> dt</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> current_time <span class="op">&lt;</span> pulse_duration:</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>        u[n <span class="op">+</span> <span class="dv">1</span>, <span class="dv">0</span>] <span class="op">=</span> pulse_amplitude <span class="op">*</span> np.sin(pulse_frequency <span class="op">*</span> current_time)</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>        u[n <span class="op">+</span> <span class="dv">1</span>, <span class="dv">0</span>] <span class="op">=</span> <span class="fl">0.0</span> <span class="co"># Motor holds firm at base after jolt</span></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Boundary Condition 2: Free End at x=L (Neumann)</span></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># u_last = u_second_to_last</span></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>    u[n <span class="op">+</span> <span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> u[n <span class="op">+</span> <span class="dv">1</span>, <span class="op">-</span><span class="dv">2</span>]</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 6. Plot the End-Effector's Vibration ---</span></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>end_effector_displacement <span class="op">=</span> u[:, <span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>plt.plot(t_vec, end_effector_displacement <span class="op">*</span> <span class="dv">1000</span>) <span class="co"># Convert to mm</span></span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Vibration of Robot End-Effector Over Time"</span>)</span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Time (s)"</span>)</span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Displacement (mm)"</span>)</span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>plt.axhline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>) <span class="co"># Zero line</span></span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>--- Robotics Challenge Parameters ---
Wave Speed c = 50.0 m/s
Courant Number C = 0.90</code></pre>
</div>
<div class="cell-output cell-output-display">
<div id="fig-robot-link-vibration" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-robot-link-vibration-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02-pde-numerical_files/figure-html/fig-robot-link-vibration-output-2.png" width="972" height="523" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-robot-link-vibration-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.6: Displacement of the robot link’s end-effector over time, showing vibrations induced by a motor jolt.
</figcaption>
</figure>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./01-intro-python.html" class="pagination-link" aria-label="Lab Session 1: Python's Scientific Stack">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Lab Session 1: Python’s Scientific Stack</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./03-laplace-basics.html" class="pagination-link" aria-label="Lab Session 3: Symbolic operations in Laplace Transform">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Lab Session 3: Symbolic operations in Laplace Transform</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>B.Tech ECE/Robotics Lab</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link active" href="https://github.com/sijuswamyresearch/PDE-T-and-OT" aria-current="page">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>